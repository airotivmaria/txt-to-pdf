<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conversor TXT - PDF</title>
</head>
<body>
    <h2>Conversor TXT para PDF</h2>
    <button id="select">Selecionar TXT</button>
    <p id="file">Nenhum arquivo selecionado</p>
    <button id="convert">Converter</button>
    <p id="result"></p>

    //Adicionando o script diretamente no HTML
    <script>
        const selectBtn = document.getElementById('select');
        const convertBtn = document.getElementById('convert');
        const fileText = document.getElementById('file');
        const resultText = document.getElementById('result');

        let filePath = null;

        selectBtn.onclick = async () => {
            filePath = await window.api.selectTxt();
            fileText.textContent = filePath ? filePath.split(/[/\\]/).pop() : 'Nenhum arquivo selecionado';
        };

        convertBtn.onclick = async () => {
            if (!filePath) return;
            const result = await window.api.convert(filePath);
            if (result.error){
                resultText.textContent = result.error;
            } else {
                const fileName = result.split(/[/\\]/).pop();
                resultText.innerHTML = `PDF gerado: ${fileName} <br><br> 
                <button id="openPDF">Abrir PDF</button>`;

                //caminho do pdf gerado
                console.log("PDF gerado em:", result);

                document.getElementById('openPDF').onclick = () => {
                    console.log('Chamando open-file com:', result);
                
                    window.api.openFile(result).then(response => {
                        if (response.error) console.error(response.error);
                    });
                };
                console.log("Abrindo arquivo:", result);
            }
        };
  </script>
</body>
</html>